# Databricks notebook source
/FileStore/tables/dates.csv

# COMMAND ----------

from pyspark.sql import SparkSession    # To initialize the Spark session
from pyspark.sql.functions  import col, expr
from pyspark.sql.functions import to_utc_timestamp, from_utc_timestamp

spark = SparkSession.builder.appName("Timezone Conversion").getOrCreate()

data = [
    (1, "2024-09-06 08:00:00"),
    (2, "2024-09-06 09:00:00"),
    (3, "2024-09-06 10:00:00"),
    (4, "2024-09-06 11:00:00"),
    (5, "2024-09-06 12:00:00"),
    (6, "2024-09-06 13:00:00"),
    (7, "2024-09-06 14:00:00"),
    (8, "2024-09-06 15:00:00"),
    (9, "2024-09-06 16:00:00"),
    (10, "2024-09-06 17:00:00"),
    (11, "2024-09-06 18:00:00"),
    (12, "2024-09-06 19:00:00"),
    (13, "2024-09-06 20:00:00"),
    (14, "2024-09-06 21:00:00"),
    (15, "2024-09-06 22:00:00"),
    (16, "2024-09-06 23:00:00"),
    (17, "2024-09-07 00:00:00"),
    (18, "2024-09-07 01:00:00"),
    (19, "2024-09-07 02:00:00"),
    (20, "2024-09-07 03:00:00"),
    (21, "2024-09-07 04:00:00"),
    (22, "2024-09-07 05:00:00"),
    (23, "2024-09-07 06:00:00"),
    (24, "2024-09-07 07:00:00"),
    (25, "2024-09-07 08:00:00"),
    (26, "2024-09-07 09:00:00"),
    (27, "2024-09-07 10:00:00"),
    (28, "2024-09-07 11:00:00"),
    (29, "2024-09-07 12:00:00"),
    (30, "2024-09-07 13:00:00"),
    (31, "2024-09-07 14:00:00"),
    (32, "2024-09-07 15:00:00"),
    (33, "2024-09-07 16:00:00"),
    (34, "2024-09-07 17:00:00"),
    (35, "2024-09-07 18:00:00"),
    (36, "2024-09-07 19:00:00"),
    (37, "2024-09-07 20:00:00"),
    (38, "2024-09-07 21:00:00"),
    (39, "2024-09-07 22:00:00"),
    (40, "2024-09-07 23:00:00"),
    (41, "2024-09-08 00:00:00"),
    (42, "2024-09-08 01:00:00"),
    (43, "2024-09-08 02:00:00"),
    (44, "2024-09-08 03:00:00"),
    (45, "2024-09-08 04:00:00"),
    (46, "2024-09-08 05:00:00"),
    (47, "2024-09-08 06:00:00"),
    (48, "2024-09-08 07:00:00"),
    (49, "2024-09-08 08:00:00"),
    (50, "2024-09-08 09:00:00")
]
columns = ["id", "date"]

# Create DataFrame
df = spark.createDataFrame(data, columns)


df.printSchema()
df.show()

# Convert 'date' column to timestamp type
df = df.withColumn("date", col("date").cast("timestamp"))


# Convert date to UTC and IST
df_with_timezone = df.withColumn("UTC", to_utc_timestamp(col("date"), "UTC")) \
                     .withColumn("IST", from_utc_timestamp(col("date"), "Asia/Kolkata"))

# Show the results
df_with_timezone.show()


